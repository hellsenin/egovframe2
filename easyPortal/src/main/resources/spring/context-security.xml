<?xml version="1.0" encoding="UTF-8"?>
<b:beans  xmlns="http://www.springframework.org/schema/security"
	xmlns:b="http://www.springframework.org/schema/beans"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
						http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-2.0.4.xsd
						http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd">

	<!-- Authentication -->
	<authentication-provider>
		<user-service>
			<user name="admin" password="admin123" authorities="ROLE_USER, ROLE_ADMIN" />
			<!-- TODO [Step 6-2] Authentication 설정 -->
			<!-- 패스워드 및 ROLE 지정 -->
			<!-- Ex : <user name="user" password="user123" authorities="ROLE_USER" /> -->
			
		</user-service>
	</authentication-provider>

	<http access-denied-page="/common/accessDenied.jsp" path-type="regex" lowercase-comparisons="false">
		<form-login login-processing-url="/j_spring_security_check"
					authentication-failure-url="/common/login.jsp?fail=true"
					default-target-url="/index.jsp"
					login-page="/common/login.jsp" />
		
		<intercept-url pattern="/common/.*\.jsp.*" filters="none" />
		<intercept-url pattern="/admin/.*" access="ROLE_ADMIN" />
		<!-- TODO [Step 6-3] Authorization 설정  -->
		<!-- url 패턴 및 접근 가능한 role 지정 -->
		<!-- Ex : <intercept-url pattern="/.*\.do.*" access="ROLE_USER" /> -->
		<anonymous/>
		<logout logout-url="/j_spring_security_logout" logout-success-url="/index.jsp" />
		<concurrent-session-control max-sessions="1" exception-if-maximum-exceeded="false" />
	</http>
	
</b:beans>
